# -*- coding: utf-8 -*-
# -------------------------------------------------------------
# Bulk Configuration
# -------------------------------------------------------------

# Set up lattice
vector_a = [24.61, 0.0, 0.0]*Angstrom
vector_b = [0.0, 34.1006, 0.0]*Angstrom
vector_c = [0.0, 0.0, 50.0]*Angstrom
lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
elements = [Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon, Carbon,
            Carbon]

# Define coordinates
fractional_coordinates = [[ 0.            ,  0.            ,  0.1           ],
                          [ 0.            ,  0.25000029325 ,  0.1           ],
                          [ 0.            ,  0.5000005865  ,  0.1           ],
                          [ 0.            ,  0.75000087975 ,  0.1           ],
                          [ 0.100000069502,  0.            ,  0.1           ],
                          [ 0.100000069502,  0.25000029325 ,  0.1           ],
                          [ 0.100000069502,  0.5000005865  ,  0.1           ],
                          [ 0.100000069502,  0.75000087975 ,  0.1           ],
                          [ 0.200000139004,  0.            ,  0.1           ],
                          [ 0.200000139004,  0.25000029325 ,  0.1           ],
                          [ 0.200000139004,  0.5000005865  ,  0.1           ],
                          [ 0.200000139004,  0.75000087975 ,  0.1           ],
                          [ 0.300000208506,  0.            ,  0.1           ],
                          [ 0.300000208506,  0.25000029325 ,  0.1           ],
                          [ 0.300000208506,  0.5000005865  ,  0.1           ],
                          [ 0.300000208506,  0.75000087975 ,  0.1           ],
                          [ 0.400000278008,  0.            ,  0.1           ],
                          [ 0.400000278008,  0.25000029325 ,  0.1           ],
                          [ 0.400000278008,  0.5000005865  ,  0.1           ],
                          [ 0.400000278008,  0.75000087975 ,  0.1           ],
                          [ 0.50000034751 ,  0.            ,  0.1           ],
                          [ 0.50000034751 ,  0.25000029325 ,  0.1           ],
                          [ 0.50000034751 ,  0.5000005865  ,  0.1           ],
                          [ 0.50000034751 ,  0.75000087975 ,  0.1           ],
                          [ 0.600000417012,  0.            ,  0.1           ],
                          [ 0.600000417012,  0.25000029325 ,  0.1           ],
                          [ 0.600000417012,  0.5000005865  ,  0.1           ],
                          [ 0.600000417012,  0.75000087975 ,  0.1           ],
                          [ 0.700000486513,  0.            ,  0.1           ],
                          [ 0.700000486513,  0.25000029325 ,  0.1           ],
                          [ 0.700000486513,  0.5000005865  ,  0.1           ],
                          [ 0.700000486513,  0.75000087975 ,  0.1           ],
                          [ 0.800000556015,  0.            ,  0.1           ],
                          [ 0.800000556015,  0.25000029325 ,  0.1           ],
                          [ 0.800000556015,  0.5000005865  ,  0.1           ],
                          [ 0.800000556015,  0.75000087975 ,  0.1           ],
                          [ 0.900000625517,  0.            ,  0.1           ],
                          [ 0.900000625517,  0.25000029325 ,  0.1           ],
                          [ 0.900000625517,  0.5000005865  ,  0.1           ],
                          [ 0.900000625517,  0.75000087975 ,  0.1           ],
                          [ 0.            ,  0.041666715542,  0.1           ],
                          [ 0.            ,  0.291667008792,  0.1           ],
                          [ 0.            ,  0.541667302042,  0.1           ],
                          [ 0.            ,  0.791667595292,  0.1           ],
                          [ 0.100000069502,  0.041666715542,  0.1           ],
                          [ 0.100000069502,  0.291667008792,  0.1           ],
                          [ 0.100000069502,  0.541667302042,  0.1           ],
                          [ 0.100000069502,  0.791667595292,  0.1           ],
                          [ 0.200000139004,  0.041666715542,  0.1           ],
                          [ 0.200000139004,  0.291667008792,  0.1           ],
                          [ 0.200000139004,  0.541667302042,  0.1           ],
                          [ 0.200000139004,  0.791667595292,  0.1           ],
                          [ 0.300000208506,  0.041666715542,  0.1           ],
                          [ 0.300000208506,  0.291667008792,  0.1           ],
                          [ 0.300000208506,  0.541667302042,  0.1           ],
                          [ 0.300000208506,  0.791667595292,  0.1           ],
                          [ 0.400000278008,  0.041666715542,  0.1           ],
                          [ 0.400000278008,  0.291667008792,  0.1           ],
                          [ 0.400000278008,  0.541667302042,  0.1           ],
                          [ 0.400000278008,  0.791667595292,  0.1           ],
                          [ 0.50000034751 ,  0.041666715542,  0.1           ],
                          [ 0.50000034751 ,  0.291667008792,  0.1           ],
                          [ 0.50000034751 ,  0.541667302042,  0.1           ],
                          [ 0.50000034751 ,  0.791667595292,  0.1           ],
                          [ 0.600000417012,  0.041666715542,  0.1           ],
                          [ 0.600000417012,  0.291667008792,  0.1           ],
                          [ 0.600000417012,  0.541667302042,  0.1           ],
                          [ 0.600000417012,  0.791667595292,  0.1           ],
                          [ 0.700000486513,  0.041666715542,  0.1           ],
                          [ 0.700000486513,  0.291667008792,  0.1           ],
                          [ 0.700000486513,  0.541667302042,  0.1           ],
                          [ 0.700000486513,  0.791667595292,  0.1           ],
                          [ 0.800000556015,  0.041666715542,  0.1           ],
                          [ 0.800000556015,  0.291667008792,  0.1           ],
                          [ 0.800000556015,  0.541667302042,  0.1           ],
                          [ 0.800000556015,  0.791667595292,  0.1           ],
                          [ 0.900000625517,  0.041666715542,  0.1           ],
                          [ 0.900000625517,  0.291667008792,  0.1           ],
                          [ 0.900000625517,  0.541667302042,  0.1           ],
                          [ 0.900000625517,  0.791667595292,  0.1           ],
                          [ 0.050000034751,  0.062500073312,  0.1           ],
                          [ 0.050000034751,  0.312500366562,  0.1           ],
                          [ 0.050000034751,  0.562500659812,  0.1           ],
                          [ 0.050000034751,  0.812500953062,  0.1           ],
                          [ 0.150000104253,  0.062500073312,  0.1           ],
                          [ 0.150000104253,  0.312500366562,  0.1           ],
                          [ 0.150000104253,  0.562500659812,  0.1           ],
                          [ 0.150000104253,  0.812500953062,  0.1           ],
                          [ 0.250000173755,  0.062500073312,  0.1           ],
                          [ 0.250000173755,  0.312500366562,  0.1           ],
                          [ 0.250000173755,  0.562500659812,  0.1           ],
                          [ 0.250000173755,  0.812500953062,  0.1           ],
                          [ 0.350000243257,  0.062500073312,  0.1           ],
                          [ 0.350000243257,  0.312500366562,  0.1           ],
                          [ 0.350000243257,  0.562500659812,  0.1           ],
                          [ 0.350000243257,  0.812500953062,  0.1           ],
                          [ 0.450000312759,  0.062500073312,  0.1           ],
                          [ 0.450000312759,  0.312500366562,  0.1           ],
                          [ 0.450000312759,  0.562500659812,  0.1           ],
                          [ 0.450000312759,  0.812500953062,  0.1           ],
                          [ 0.550000382261,  0.062500073312,  0.1           ],
                          [ 0.550000382261,  0.312500366562,  0.1           ],
                          [ 0.550000382261,  0.562500659812,  0.1           ],
                          [ 0.550000382261,  0.812500953062,  0.1           ],
                          [ 0.650000451762,  0.062500073312,  0.1           ],
                          [ 0.650000451762,  0.312500366562,  0.1           ],
                          [ 0.650000451762,  0.562500659812,  0.1           ],
                          [ 0.650000451762,  0.812500953062,  0.1           ],
                          [ 0.750000521264,  0.062500073312,  0.1           ],
                          [ 0.750000521264,  0.312500366562,  0.1           ],
                          [ 0.750000521264,  0.562500659812,  0.1           ],
                          [ 0.750000521264,  0.812500953062,  0.1           ],
                          [ 0.850000590766,  0.062500073312,  0.1           ],
                          [ 0.850000590766,  0.312500366562,  0.1           ],
                          [ 0.850000590766,  0.562500659812,  0.1           ],
                          [ 0.850000590766,  0.812500953062,  0.1           ],
                          [ 0.950000660268,  0.062500073312,  0.1           ],
                          [ 0.950000660268,  0.312500366562,  0.1           ],
                          [ 0.950000660268,  0.562500659812,  0.1           ],
                          [ 0.950000660268,  0.812500953062,  0.1           ],
                          [ 0.050000034751,  0.104166788854,  0.1           ],
                          [ 0.050000034751,  0.354167082104,  0.1           ],
                          [ 0.050000034751,  0.604167375354,  0.1           ],
                          [ 0.050000034751,  0.854167668604,  0.1           ],
                          [ 0.150000104253,  0.104166788854,  0.1           ],
                          [ 0.150000104253,  0.354167082104,  0.1           ],
                          [ 0.150000104253,  0.604167375354,  0.1           ],
                          [ 0.150000104253,  0.854167668604,  0.1           ],
                          [ 0.250000173755,  0.104166788854,  0.1           ],
                          [ 0.250000173755,  0.354167082104,  0.1           ],
                          [ 0.250000173755,  0.604167375354,  0.1           ],
                          [ 0.250000173755,  0.854167668604,  0.1           ],
                          [ 0.350000243257,  0.104166788854,  0.1           ],
                          [ 0.350000243257,  0.354167082104,  0.1           ],
                          [ 0.350000243257,  0.604167375354,  0.1           ],
                          [ 0.350000243257,  0.854167668604,  0.1           ],
                          [ 0.450000312759,  0.104166788854,  0.1           ],
                          [ 0.450000312759,  0.354167082104,  0.1           ],
                          [ 0.450000312759,  0.604167375354,  0.1           ],
                          [ 0.450000312759,  0.854167668604,  0.1           ],
                          [ 0.550000382261,  0.104166788854,  0.1           ],
                          [ 0.550000382261,  0.354167082104,  0.1           ],
                          [ 0.550000382261,  0.604167375354,  0.1           ],
                          [ 0.550000382261,  0.854167668604,  0.1           ],
                          [ 0.650000451762,  0.104166788854,  0.1           ],
                          [ 0.650000451762,  0.354167082104,  0.1           ],
                          [ 0.650000451762,  0.604167375354,  0.1           ],
                          [ 0.650000451762,  0.854167668604,  0.1           ],
                          [ 0.750000521264,  0.104166788854,  0.1           ],
                          [ 0.750000521264,  0.354167082104,  0.1           ],
                          [ 0.750000521264,  0.604167375354,  0.1           ],
                          [ 0.750000521264,  0.854167668604,  0.1           ],
                          [ 0.850000590766,  0.104166788854,  0.1           ],
                          [ 0.850000590766,  0.354167082104,  0.1           ],
                          [ 0.850000590766,  0.604167375354,  0.1           ],
                          [ 0.850000590766,  0.854167668604,  0.1           ],
                          [ 0.950000660268,  0.104166788854,  0.1           ],
                          [ 0.950000660268,  0.354167082104,  0.1           ],
                          [ 0.950000660268,  0.604167375354,  0.1           ],
                          [ 0.950000660268,  0.854167668604,  0.1           ],
                          [ 0.            ,  0.125000146625,  0.1           ],
                          [ 0.            ,  0.375000439875,  0.1           ],
                          [ 0.            ,  0.625000733125,  0.1           ],
                          [ 0.            ,  0.875001026375,  0.1           ],
                          [ 0.100000069502,  0.125000146625,  0.1           ],
                          [ 0.100000069502,  0.375000439875,  0.1           ],
                          [ 0.100000069502,  0.625000733125,  0.1           ],
                          [ 0.100000069502,  0.875001026375,  0.1           ],
                          [ 0.200000139004,  0.125000146625,  0.1           ],
                          [ 0.200000139004,  0.375000439875,  0.1           ],
                          [ 0.200000139004,  0.625000733125,  0.1           ],
                          [ 0.200000139004,  0.875001026375,  0.1           ],
                          [ 0.300000208506,  0.125000146625,  0.1           ],
                          [ 0.300000208506,  0.375000439875,  0.1           ],
                          [ 0.300000208506,  0.625000733125,  0.1           ],
                          [ 0.300000208506,  0.875001026375,  0.1           ],
                          [ 0.400000278008,  0.125000146625,  0.1           ],
                          [ 0.400000278008,  0.375000439875,  0.1           ],
                          [ 0.400000278008,  0.625000733125,  0.1           ],
                          [ 0.400000278008,  0.875001026375,  0.1           ],
                          [ 0.50000034751 ,  0.125000146625,  0.1           ],
                          [ 0.50000034751 ,  0.375000439875,  0.1           ],
                          [ 0.50000034751 ,  0.625000733125,  0.1           ],
                          [ 0.50000034751 ,  0.875001026375,  0.1           ],
                          [ 0.600000417012,  0.125000146625,  0.1           ],
                          [ 0.600000417012,  0.375000439875,  0.1           ],
                          [ 0.600000417012,  0.625000733125,  0.1           ],
                          [ 0.600000417012,  0.875001026375,  0.1           ],
                          [ 0.700000486513,  0.125000146625,  0.1           ],
                          [ 0.700000486513,  0.375000439875,  0.1           ],
                          [ 0.700000486513,  0.625000733125,  0.1           ],
                          [ 0.700000486513,  0.875001026375,  0.1           ],
                          [ 0.800000556015,  0.125000146625,  0.1           ],
                          [ 0.800000556015,  0.375000439875,  0.1           ],
                          [ 0.800000556015,  0.625000733125,  0.1           ],
                          [ 0.800000556015,  0.875001026375,  0.1           ],
                          [ 0.900000625517,  0.125000146625,  0.1           ],
                          [ 0.900000625517,  0.375000439875,  0.1           ],
                          [ 0.900000625517,  0.625000733125,  0.1           ],
                          [ 0.900000625517,  0.875001026375,  0.1           ],
                          [ 0.            ,  0.166666862167,  0.1           ],
                          [ 0.            ,  0.416667155417,  0.1           ],
                          [ 0.            ,  0.666667448667,  0.1           ],
                          [ 0.            ,  0.916667741917,  0.1           ],
                          [ 0.100000069502,  0.166666862167,  0.1           ],
                          [ 0.100000069502,  0.416667155417,  0.1           ],
                          [ 0.100000069502,  0.666667448667,  0.1           ],
                          [ 0.100000069502,  0.916667741917,  0.1           ],
                          [ 0.200000139004,  0.166666862167,  0.1           ],
                          [ 0.200000139004,  0.416667155417,  0.1           ],
                          [ 0.200000139004,  0.666667448667,  0.1           ],
                          [ 0.200000139004,  0.916667741917,  0.1           ],
                          [ 0.300000208506,  0.166666862167,  0.1           ],
                          [ 0.300000208506,  0.416667155417,  0.1           ],
                          [ 0.300000208506,  0.666667448667,  0.1           ],
                          [ 0.300000208506,  0.916667741917,  0.1           ],
                          [ 0.400000278008,  0.166666862167,  0.1           ],
                          [ 0.400000278008,  0.416667155417,  0.1           ],
                          [ 0.400000278008,  0.666667448667,  0.1           ],
                          [ 0.400000278008,  0.916667741917,  0.1           ],
                          [ 0.50000034751 ,  0.166666862167,  0.1           ],
                          [ 0.50000034751 ,  0.416667155417,  0.1           ],
                          [ 0.50000034751 ,  0.666667448667,  0.1           ],
                          [ 0.50000034751 ,  0.916667741917,  0.1           ],
                          [ 0.600000417012,  0.166666862167,  0.1           ],
                          [ 0.600000417012,  0.416667155417,  0.1           ],
                          [ 0.600000417012,  0.666667448667,  0.1           ],
                          [ 0.600000417012,  0.916667741917,  0.1           ],
                          [ 0.700000486513,  0.166666862167,  0.1           ],
                          [ 0.700000486513,  0.416667155417,  0.1           ],
                          [ 0.700000486513,  0.666667448667,  0.1           ],
                          [ 0.700000486513,  0.916667741917,  0.1           ],
                          [ 0.800000556015,  0.166666862167,  0.1           ],
                          [ 0.800000556015,  0.416667155417,  0.1           ],
                          [ 0.800000556015,  0.666667448667,  0.1           ],
                          [ 0.800000556015,  0.916667741917,  0.1           ],
                          [ 0.900000625517,  0.166666862167,  0.1           ],
                          [ 0.900000625517,  0.416667155417,  0.1           ],
                          [ 0.900000625517,  0.666667448667,  0.1           ],
                          [ 0.900000625517,  0.916667741917,  0.1           ],
                          [ 0.050000034751,  0.187500219937,  0.1           ],
                          [ 0.050000034751,  0.437500513187,  0.1           ],
                          [ 0.050000034751,  0.687500806437,  0.1           ],
                          [ 0.050000034751,  0.937501099687,  0.1           ],
                          [ 0.150000104253,  0.187500219937,  0.1           ],
                          [ 0.150000104253,  0.437500513187,  0.1           ],
                          [ 0.150000104253,  0.687500806437,  0.1           ],
                          [ 0.150000104253,  0.937501099687,  0.1           ],
                          [ 0.250000173755,  0.187500219937,  0.1           ],
                          [ 0.250000173755,  0.437500513187,  0.1           ],
                          [ 0.250000173755,  0.687500806437,  0.1           ],
                          [ 0.250000173755,  0.937501099687,  0.1           ],
                          [ 0.350000243257,  0.187500219937,  0.1           ],
                          [ 0.350000243257,  0.437500513187,  0.1           ],
                          [ 0.350000243257,  0.687500806437,  0.1           ],
                          [ 0.350000243257,  0.937501099687,  0.1           ],
                          [ 0.450000312759,  0.187500219937,  0.1           ],
                          [ 0.450000312759,  0.437500513187,  0.1           ],
                          [ 0.450000312759,  0.687500806437,  0.1           ],
                          [ 0.450000312759,  0.937501099687,  0.1           ],
                          [ 0.550000382261,  0.187500219937,  0.1           ],
                          [ 0.550000382261,  0.437500513187,  0.1           ],
                          [ 0.550000382261,  0.687500806437,  0.1           ],
                          [ 0.550000382261,  0.937501099687,  0.1           ],
                          [ 0.650000451762,  0.187500219937,  0.1           ],
                          [ 0.650000451762,  0.437500513187,  0.1           ],
                          [ 0.650000451762,  0.687500806437,  0.1           ],
                          [ 0.650000451762,  0.937501099687,  0.1           ],
                          [ 0.750000521264,  0.187500219937,  0.1           ],
                          [ 0.750000521264,  0.437500513187,  0.1           ],
                          [ 0.750000521264,  0.687500806437,  0.1           ],
                          [ 0.750000521264,  0.937501099687,  0.1           ],
                          [ 0.850000590766,  0.187500219937,  0.1           ],
                          [ 0.850000590766,  0.437500513187,  0.1           ],
                          [ 0.850000590766,  0.687500806437,  0.1           ],
                          [ 0.850000590766,  0.937501099687,  0.1           ],
                          [ 0.950000660268,  0.187500219937,  0.1           ],
                          [ 0.950000660268,  0.437500513187,  0.1           ],
                          [ 0.950000660268,  0.687500806437,  0.1           ],
                          [ 0.950000660268,  0.937501099687,  0.1           ],
                          [ 0.050000034751,  0.229166935479,  0.1           ],
                          [ 0.050000034751,  0.479167228729,  0.1           ],
                          [ 0.050000034751,  0.729167521979,  0.1           ],
                          [ 0.050000034751,  0.979167815229,  0.1           ],
                          [ 0.150000104253,  0.229166935479,  0.1           ],
                          [ 0.150000104253,  0.479167228729,  0.1           ],
                          [ 0.150000104253,  0.729167521979,  0.1           ],
                          [ 0.150000104253,  0.979167815229,  0.1           ],
                          [ 0.250000173755,  0.229166935479,  0.1           ],
                          [ 0.250000173755,  0.479167228729,  0.1           ],
                          [ 0.250000173755,  0.729167521979,  0.1           ],
                          [ 0.250000173755,  0.979167815229,  0.1           ],
                          [ 0.350000243257,  0.229166935479,  0.1           ],
                          [ 0.350000243257,  0.479167228729,  0.1           ],
                          [ 0.350000243257,  0.729167521979,  0.1           ],
                          [ 0.350000243257,  0.979167815229,  0.1           ],
                          [ 0.450000312759,  0.229166935479,  0.1           ],
                          [ 0.450000312759,  0.479167228729,  0.1           ],
                          [ 0.450000312759,  0.729167521979,  0.1           ],
                          [ 0.450000312759,  0.979167815229,  0.1           ],
                          [ 0.550000382261,  0.229166935479,  0.1           ],
                          [ 0.550000382261,  0.479167228729,  0.1           ],
                          [ 0.550000382261,  0.729167521979,  0.1           ],
                          [ 0.550000382261,  0.979167815229,  0.1           ],
                          [ 0.650000451762,  0.229166935479,  0.1           ],
                          [ 0.650000451762,  0.479167228729,  0.1           ],
                          [ 0.650000451762,  0.729167521979,  0.1           ],
                          [ 0.650000451762,  0.979167815229,  0.1           ],
                          [ 0.750000521264,  0.229166935479,  0.1           ],
                          [ 0.750000521264,  0.479167228729,  0.1           ],
                          [ 0.750000521264,  0.729167521979,  0.1           ],
                          [ 0.750000521264,  0.979167815229,  0.1           ],
                          [ 0.850000590766,  0.229166935479,  0.1           ],
                          [ 0.850000590766,  0.479167228729,  0.1           ],
                          [ 0.850000590766,  0.729167521979,  0.1           ],
                          [ 0.850000590766,  0.979167815229,  0.1           ],
                          [ 0.950000660268,  0.229166935479,  0.1           ],
                          [ 0.950000660268,  0.479167228729,  0.1           ],
                          [ 0.950000660268,  0.729167521979,  0.1           ],
                          [ 0.950000660268,  0.979167815229,  0.1           ],
                          [ 0.450000312759,  0.479167228729,  0.7           ]]

# Set up configuration
bulk_configuration = BulkConfiguration(
    bravais_lattice=lattice,
    elements=elements,
    fractional_coordinates=fractional_coordinates
    )

# Add tags
bulk_configuration.addTags('Selection 0', [320])

# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------

potentialSet = Tersoff_SiC_1998()
calculator = TremoloXCalculator(parameters=potentialSet)
calculator.setVerletListsDelta(0.25*Angstrom)

bulk_configuration.setCalculator(calculator)
nlprint(bulk_configuration)
bulk_configuration.update()
nlsave('(2,2) Graphene Nanosheet.hdf5', bulk_configuration)

# -------------------------------------------------------------
# Molecular Dynamics
# -------------------------------------------------------------

initial_velocity = MaxwellBoltzmannDistribution(
    temperature=300.0*Kelvin,
    remove_center_of_mass_momentum=True
)

method = Langevin(
    time_step=1*femtoSecond,
    reservoir_temperature=300*Kelvin,
    friction=0.01*femtoSecond**-1,
    initial_velocity=initial_velocity,
    heating_rate=0*Kelvin/picoSecond,
)

fix_atom_indices_0 = [320]

constraints = [FixAtomConstraints(fix_atom_indices_0)]

md_trajectory = MolecularDynamics(
    bulk_configuration,
    constraints=constraints,
    trajectory_filename='graphene_sheet_equilibrate.hdf5',
    steps=100000,
    log_interval=1000,
    method=method
)

bulk_configuration = md_trajectory.lastImage()

# -------------------------------------------------------------
# Get the velocities from the bulk_configuration
velocities = bulk_configuration.velocities()
# Define the incident energy of the bombardment atom.
incident_energy = 10.0*eV
# Calculate the corresponding velocity and apply it to the last atom.
incident_velocity = ((2.0*incident_energy/Carbon.atomicMass())**0.5).inUnitsOf(Ang/fs)
velocities[-1, :] = [0.0, 0.0, -incident_velocity]*Ang/fs
bulk_configuration.setVelocities(velocities)
# -------------------------------------------------------------

# -------------------------------------------------------------
# Molecular Dynamics
# -------------------------------------------------------------

initial_velocity = ConfigurationVelocities(
    remove_center_of_mass_momentum=False
)

method = NVEVelocityVerlet(
    time_step=0.05*femtoSecond,
    initial_velocity=initial_velocity,
)

md_trajectory = MolecularDynamics(
    bulk_configuration,
    constraints=[],
    trajectory_filename='ion_bombardment_traj.hdf5',
    steps=50000,
    log_interval=100,
    method=method
)

bulk_configuration = md_trajectory.lastImage()
